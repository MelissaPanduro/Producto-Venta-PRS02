<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[9999] 
            transition-opacity duration-300 ease-in-out"
     [ngClass]="{ 'animate-fadeIn': isOpen, 'animate-fadeOut': !isOpen }"
     *ngIf="isOpen">
  <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg p-6 relative z-[10000] 
              transform transition-transform duration-300 scale-95"
       [ngClass]="{ 'scale-100': isOpen, 'scale-95': !isOpen }">
    <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">
      {{ isEditMode ? 'Editar Kardex' : 'Crear Kardex' }}
    </h2>

    <form (ngSubmit)="onSubmit()" #kardexForm="ngForm" novalidate>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700">Nombre</label>
          <input type="text" [(ngModel)]="typeKardex.name" name="name" required
            class="mt-1 block w-full rounded-lg border border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
          <div *ngIf="kardexForm.submitted && !kardexForm.controls['name']?.valid" class="text-red-500 text-sm">
            El nombre es obligatorio.
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Cantidad Máxima</label>
          <input type="number" [(ngModel)]="typeKardex.maximumAmount" name="maximumAmount" required min="1"
            class="mt-1 block w-full rounded-lg border border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
          <div *ngIf="kardexForm.submitted && !kardexForm.controls['maximumAmount']?.valid" class="text-red-500 text-sm">
            La cantidad máxima es obligatoria y debe ser mayor a 0.
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Cantidad Mínima</label>
          <input type="number" [(ngModel)]="typeKardex.minimumQuantity" name="minimumQuantity" required min="1"
            class="mt-1 block w-full rounded-lg border border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
          <div *ngIf="kardexForm.submitted && !kardexForm.controls['minimumQuantity']?.valid" class="text-red-500 text-sm">
            La cantidad mínima es obligatoria y debe ser mayor a 0.
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Proveedor</label>
          <select [(ngModel)]="typeKardex.supplierId" name="supplierId" required
            class="mt-1 block w-full rounded-lg border border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="" disabled selected>Selecciona un proveedor</option>
            <option *ngFor="let supplier of suppliers" [ngValue]="supplier.id">
              {{ supplier.company }}
            </option>
          </select>
          <div *ngIf="kardexForm.submitted && !kardexForm.controls['supplierId']?.valid" class="text-red-500 text-sm">
            El proveedor es obligatorio.
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Producto</label>
          <select [(ngModel)]="typeKardex.productId" name="productId" required
            class="mt-1 block w-full rounded-lg border border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="" disabled selected>Selecciona un producto</option>
            <option *ngFor="let product of products" [value]="product.id">
              {{ product.type }}
            </option>
          </select>
          <div *ngIf="kardexForm.submitted && !kardexForm.controls['productId']?.valid" class="text-red-500 text-sm">
            El producto es obligatorio.
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Shed</label>
          <select [(ngModel)]="typeKardex.shedId" name="shedId" required
            class="mt-1 block w-full rounded-lg border border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="" disabled selected>Selecciona un shed</option>
            <option *ngFor="let shed of sheds" [ngValue]="shed.id">
              {{ shed.name }}
            </option>
          </select>
          <div *ngIf="kardexForm.submitted && !kardexForm.controls['shedId']?.valid" class="text-red-500 text-sm">
            El shed es obligatorio.
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Descripción</label>
          <textarea [(ngModel)]="typeKardex.description" name="description" required
            class="mt-1 block w-full rounded-lg border border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
          <div *ngIf="kardexForm.submitted && !kardexForm.controls['description']?.valid" class="text-red-500 text-sm">
            La descripción es obligatoria.
          </div>
        </div>
      </div>

      <div class="mt-6 flex justify-end space-x-4">
        <button type="button" (click)="closeModal()"
          class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all">
          Cancelar
        </button>
        <button type="submit" [disabled]="!kardexForm.valid"
          class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all">
          {{ isEditMode ? 'Actualizar' : 'Crear' }}
        </button>
      </div>
    </form>
  </div>
</div>
